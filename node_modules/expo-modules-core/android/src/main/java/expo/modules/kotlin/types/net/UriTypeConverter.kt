package expo.modules.kotlin.types.net

import android.net.Uri
import com.facebook.react.bridge.Dynamic
import expo.modules.kotlin.AppContext
import expo.modules.kotlin.jni.CppType
import expo.modules.kotlin.jni.ExpectedType
import expo.modules.kotlin.types.DynamicAwareTypeConverters
import java.net.URI
<<<<<<< HEAD
import androidx.core.net.toUri
import expo.modules.kotlin.exception.DynamicCastException

class UriTypeConverter : DynamicAwareTypeConverters<Uri>() {
  override fun convertFromDynamic(value: Dynamic, context: AppContext?, forceConversion: Boolean): Uri {
    val stringUri = value.asString()
    return stringUri?.toUri() ?: throw DynamicCastException(Uri::class)
  }

  override fun convertFromAny(value: Any, context: AppContext?, forceConversion: Boolean): Uri {
    val stringUri = value as String
    return stringUri.toUri()
=======

class UriTypeConverter(isOptional: Boolean) : DynamicAwareTypeConverters<Uri>(isOptional) {
  override fun convertFromDynamic(value: Dynamic, context: AppContext?): Uri {
    val stringUri = value.asString()
    return Uri.parse(stringUri)
  }

  override fun convertFromAny(value: Any, context: AppContext?): Uri {
    val stringUri = value as String
    return Uri.parse(stringUri)
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767
  }

  override fun getCppRequiredTypes(): ExpectedType = ExpectedType(CppType.STRING)

  override fun isTrivial() = false
}

<<<<<<< HEAD
class JavaURITypeConverter : DynamicAwareTypeConverters<URI>() {
  override fun convertFromDynamic(value: Dynamic, context: AppContext?, forceConversion: Boolean): URI {
=======
class JavaURITypeConverter(isOptional: Boolean) : DynamicAwareTypeConverters<URI>(isOptional) {
  override fun convertFromDynamic(value: Dynamic, context: AppContext?): URI {
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767
    val stringUri = value.asString()
    return URI.create(stringUri)
  }

<<<<<<< HEAD
  override fun convertFromAny(value: Any, context: AppContext?, forceConversion: Boolean): URI {
=======
  override fun convertFromAny(value: Any, context: AppContext?): URI {
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767
    val stringUri = value as String
    return URI.create(stringUri)
  }

  override fun getCppRequiredTypes(): ExpectedType = ExpectedType(CppType.STRING)

  override fun isTrivial() = false
}
