#!/usr/bin/env node

/**
 * @license
 * Copyright 2023 Google Inc.
 * SPDX-License-Identifier: Apache-2.0
 */

import {CLI, Browser} from '@puppeteer/browsers';
import {packageVersion} from 'puppeteer-core/internal/generated/version.js';
<<<<<<< HEAD
import type {PuppeteerNode} from 'puppeteer-core/internal/node/PuppeteerNode.js';
=======
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767
import {PUPPETEER_REVISIONS} from 'puppeteer-core/internal/revisions.js';

import puppeteer from '../puppeteer.js';

<<<<<<< HEAD
const cacheDir = (puppeteer as unknown as PuppeteerNode).configuration
  .cacheDirectory!;
=======
const cacheDir = puppeteer.configuration.cacheDirectory!;
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767

void new CLI({
  cachePath: cacheDir,
  scriptName: 'puppeteer',
  version: packageVersion,
  prefixCommand: {
    cmd: 'browsers',
    description: 'Manage browsers of this Puppeteer installation',
  },
  allowCachePathOverride: false,
  pinnedBrowsers: {
    [Browser.CHROME]: {
      buildId:
<<<<<<< HEAD
        (puppeteer as unknown as PuppeteerNode).configuration.chrome?.version ||
        PUPPETEER_REVISIONS['chrome'] ||
        'latest',
      skipDownload:
        (puppeteer as unknown as PuppeteerNode).configuration.chrome
          ?.skipDownload ?? false,
    },
    [Browser.FIREFOX]: {
      buildId:
        (puppeteer as unknown as PuppeteerNode).configuration.firefox
          ?.version ||
        PUPPETEER_REVISIONS['firefox'] ||
        'latest',
      skipDownload:
        (puppeteer as unknown as PuppeteerNode).configuration.firefox
          ?.skipDownload ?? true,
    },
    [Browser.CHROMEHEADLESSSHELL]: {
      buildId:
        (puppeteer as unknown as PuppeteerNode).configuration[
          'chrome-headless-shell'
        ]?.version ||
        PUPPETEER_REVISIONS['chrome-headless-shell'] ||
        'latest',
      skipDownload:
        (puppeteer as unknown as PuppeteerNode).configuration[
          'chrome-headless-shell'
        ]?.skipDownload ?? false,
=======
        puppeteer.configuration.chrome?.version ||
        PUPPETEER_REVISIONS['chrome'] ||
        'latest',
      skipDownload: puppeteer.configuration.chrome?.skipDownload ?? false,
    },
    [Browser.FIREFOX]: {
      buildId:
        puppeteer.configuration.firefox?.version ||
        PUPPETEER_REVISIONS['firefox'] ||
        'latest',
      skipDownload: puppeteer.configuration.firefox?.skipDownload ?? true,
    },
    [Browser.CHROMEHEADLESSSHELL]: {
      buildId:
        puppeteer.configuration['chrome-headless-shell']?.version ||
        PUPPETEER_REVISIONS['chrome-headless-shell'] ||
        'latest',
      skipDownload:
        puppeteer.configuration['chrome-headless-shell']?.skipDownload ?? false,
>>>>>>> 2c830f7d0232ead70791aff6968a0e95ce850767
    },
  },
}).run(process.argv);
